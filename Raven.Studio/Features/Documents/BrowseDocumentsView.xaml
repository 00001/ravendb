<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:tk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
			 xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
			 xmlns:local="clr-namespace:Raven.Studio.Behaviors"
			 xmlns:cm="http://www.caliburnproject.org"
			 xmlns:c="clr-namespace:Raven.Studio.Controls"
			 xmlns:f="clr-namespace:Raven.Studio.Framework"
			 xmlns:sh="clr-namespace:Raven.Studio.Controls.SyntaxHighlighting;assembly=Raven.Studio.Controls.SyntaxHighlighting"
			 xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
			 x:Class="Raven.Studio.Features.Documents.BrowseDocumentsView"
			 mc:Ignorable="d"
			 d:DesignWidth="640"
			 d:DesignHeight="480"
			 d:DataContext="{d:DesignData /SampleData/BrowseDocumentsViewModelSampleData.xaml}">

	<Grid Background="{StaticResource DefaultScreenBackground}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<tk:DockPanel d:IsLocked="True">
			<TextBlock Text="Documents"
					   tk:DockPanel.Dock="Left"
					   Style="{StaticResource Header}" />

			<StackPanel Orientation="Horizontal"
						tk:DockPanel.Dock="Right"
						HorizontalAlignment="Right"
						VerticalAlignment="Bottom"
						Margin="0,0,0,10">
				<TextBox MinWidth="350"
						 x:Name="documentId">
					<i:Interaction.Behaviors>
						<local:Watermark Text="Search by Document Id"
										 Foreground="LightGray" />
					</i:Interaction.Behaviors>
				</TextBox>
				<HyperlinkButton Style="{StaticResource SearchButtonStyle}"
								 cm:Action.TargetWithoutContext="SearchForDocumentById"
								 cm:Message.Attach="Execute(documentId)" />
			</StackPanel>
		</tk:DockPanel>

		<Grid Grid.Row="1">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
				<RowDefinition Height="Auto" />
			</Grid.RowDefinitions>

			<c:Pager Grid.Row="0"
					 cm:Bind.Model="{Binding Documents}" />

			<ListBox Grid.Row="1"
					 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
					 BorderThickness="0"
					 ItemsSource="{Binding Documents}">
				<ListBox.ItemsPanel>
					<ItemsPanelTemplate>
						<tk:WrapPanel>
							<i:Interaction.Behaviors>
								<ei:FluidMoveBehavior AppliesTo="Children"
													  Duration="0:0:0.5">
									<ei:FluidMoveBehavior.EaseY>
										<CircleEase EasingMode="EaseInOut" />
									</ei:FluidMoveBehavior.EaseY>
									<ei:FluidMoveBehavior.EaseX>
										<CubicEase EasingMode="EaseInOut" />
									</ei:FluidMoveBehavior.EaseX>
								</ei:FluidMoveBehavior>
							</i:Interaction.Behaviors>
						</tk:WrapPanel>
					</ItemsPanelTemplate>
				</ListBox.ItemsPanel>
				<ListBox.ItemTemplate>
					<DataTemplate>
						<Grid cm:Action.TargetWithoutContext="EditDocument"
							  f:DoubleClickEvent.AttachAction="Execute($dataContext)"
							  Background="Transparent">
							<ToolTipService.ToolTip>
								<ContentControl cm:View.Model="{Binding}"
												cm:View.Context="Tooltip" />
							</ToolTipService.ToolTip>
							<tk:ContextMenuService.ContextMenu>
								<tk:ContextMenu>
									<tk:MenuItem Header="Edit Document"
												 cm:Action.TargetWithoutContext="EditDocument"
												 cm:Message.Attach="Click=Execute($dataContext)" />
									<tk:MenuItem Header="Delete Document"
												 cm:Action.TargetWithoutContext="DeleteDocument"
												 cm:Message.Attach="Click=Execute($dataContext)" />
								</tk:ContextMenu>
							</tk:ContextMenuService.ContextMenu>
							<ContentControl Content="{Binding}"
											ContentTemplate="{Binding DataTemplate}" />
						</Grid>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>

			<!-- the visibility binding didn't work until I used Bind.Model; not sure why... -->
			<TextBlock Grid.Row="1"
					   cm:Bind.Model="{Binding Documents}"
					   Style="{StaticResource Instruction}"
					   Text="The database contains no documents."
					   Visibility="{Binding HasNoResults, Converter={StaticResource booleanToVisibility}}"
					   d:IsHidden="True"
					   d:IsLocked="True" />

			<c:Pager Grid.Row="2"
					 cm:Bind.Model="{Binding Documents}" />
		</Grid>

	</Grid>

</UserControl>