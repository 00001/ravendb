<UserControl
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:tk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
			 xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
			 xmlns:local="clr-namespace:Raven.Studio.Behaviors"
			 xmlns:cm="http://www.caliburnproject.org"
			 xmlns:c="clr-namespace:Raven.Studio.Controls"
			 xmlns:f="clr-namespace:Raven.Studio.Framework"
			 xmlns:sh="clr-namespace:Raven.Studio.Controls.SyntaxHighlighting;assembly=Raven.Studio.Controls.SyntaxHighlighting"
			 xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" x:Class="Raven.Studio.Features.Documents.BrowseDocumentsView"
			 mc:Ignorable="d" d:DesignWidth="640" d:DesignHeight="480" d:DataContext="{d:DesignData /SampleData/BrowseDocumentsViewModelSampleData.xaml}">
	<UserControl.Resources>
		<Style x:Key="ListBoxItemStyle1" TargetType="ListBoxItem">
			<Setter Property="Padding" Value="3"/>
			<Setter Property="HorizontalContentAlignment" Value="Left"/>
			<Setter Property="VerticalContentAlignment" Value="Top"/>
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="TabNavigation" Value="Local"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ListBoxItem">
						<Grid x:Name="grid" Background="{TemplateBinding Background}">
							<Grid.Projection>
								<PlaneProjection/>
							</Grid.Projection>
							<VisualStateManager.VisualStateGroups>
								<VisualStateGroup x:Name="CommonStates">
									<VisualState x:Name="Normal"/>
									<VisualState x:Name="MouseOver">
										<Storyboard>
											<DoubleAnimation Duration="0" To=".35" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="fillColor"/>
										</Storyboard>
									</VisualState>
									<VisualState x:Name="Disabled">
										<Storyboard>
											<DoubleAnimation Duration="0" To=".55" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="contentPresenter"/>
										</Storyboard>
									</VisualState>
								</VisualStateGroup>
								<VisualStateGroup x:Name="SelectionStates">
									<VisualState x:Name="Unselected"/>
									<VisualState x:Name="Selected">
										<Storyboard>
											<DoubleAnimation Duration="0" To=".75" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="fillColor2"/>
										</Storyboard>
									</VisualState>
								</VisualStateGroup>
								<VisualStateGroup x:Name="FocusStates">
									<VisualState x:Name="Focused">
										<Storyboard>
											<ObjectAnimationUsingKeyFrames Duration="0" Storyboard.TargetProperty="Visibility" Storyboard.TargetName="FocusVisualElement">
												<DiscreteObjectKeyFrame KeyTime="0">
													<DiscreteObjectKeyFrame.Value>
														<Visibility>Visible</Visibility>
													</DiscreteObjectKeyFrame.Value>
												</DiscreteObjectKeyFrame>
											</ObjectAnimationUsingKeyFrames>
										</Storyboard>
									</VisualState>
									<VisualState x:Name="Unfocused"/>
								</VisualStateGroup>
								<VisualStateGroup x:Name="LayoutStates">
									<VisualStateGroup.Transitions>
										<VisualTransition GeneratedDuration="0:0:0.5"/>
									</VisualStateGroup.Transitions>
									<VisualState x:Name="AfterLoaded"/>
									<VisualState x:Name="BeforeLoaded">
										<Storyboard>
											<DoubleAnimation Duration="0" To="-4.295" Storyboard.TargetProperty="(UIElement.Projection).(PlaneProjection.RotationX)" Storyboard.TargetName="grid" d:IsOptimized="True"/>
											<DoubleAnimation Duration="0" To="-47.789" Storyboard.TargetProperty="(UIElement.Projection).(PlaneProjection.RotationY)" Storyboard.TargetName="grid" d:IsOptimized="True"/>
											<DoubleAnimation Duration="0" To="8.886" Storyboard.TargetProperty="(UIElement.Projection).(PlaneProjection.RotationZ)" Storyboard.TargetName="grid" d:IsOptimized="True"/>
										</Storyboard>
									</VisualState>
									<VisualState x:Name="BeforeUnloaded"/>
								</VisualStateGroup>
							</VisualStateManager.VisualStateGroups>
							<Rectangle x:Name="fillColor" Fill="#FFBADDE9" IsHitTestVisible="False" Opacity="0" RadiusY="1" RadiusX="1"/>
							<Rectangle x:Name="fillColor2" Fill="#FFBADDE9" IsHitTestVisible="False" Opacity="0" RadiusY="1" RadiusX="1"/>
							<ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"/>
							<Rectangle x:Name="FocusVisualElement" RadiusY="1" RadiusX="1" Stroke="#FF6DBDD1" StrokeThickness="1" Visibility="Collapsed"/>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
	</UserControl.Resources>
	<Grid Background="{StaticResource DefaultScreenBackground}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<tk:DockPanel d:IsLocked="True">
			<TextBlock Text="Documents"
					   tk:DockPanel.Dock="Left"
					   Style="{StaticResource Header}" />

			<StackPanel Orientation="Horizontal"
						tk:DockPanel.Dock="Right"
						HorizontalAlignment="Right"
						VerticalAlignment="Bottom"
						Margin="0,0,0,10">
				<TextBox MinWidth="350"
						 x:Name="documentId">
					<i:Interaction.Behaviors>
						<local:Watermark Text="Search by Document Id"
							Foreground="LightGray" />
					</i:Interaction.Behaviors>
				</TextBox>
				<HyperlinkButton Style="{StaticResource SearchButtonStyle}"
								 cm:Action.TargetWithoutContext="SearchForDocumentById"
								 cm:Message.Attach="Execute(documentId)" />
			</StackPanel>
		</tk:DockPanel>

		<tk:BusyIndicator IsBusy="{Binding IsBusy}"
						  Grid.Row="1">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="*" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<c:Pager Grid.Row="0"
						 cm:Bind.Model="{Binding Documents}" />

				<ListBox Grid.Row="1"
						 BorderThickness="0"
						 ItemsSource="{Binding Documents}" ItemContainerStyle="{StaticResource ListBoxItemStyle1}">
					<ListBox.ItemTemplate>
						<DataTemplate>
							<StackPanel cm:Action.TargetWithoutContext="EditDocument"
										cm:Message.Attach="[Event MouseLeftButtonDown] = [Execute($dataContext)]">
								<TextBlock Text="{Binding Id}"
										   FontWeight="Bold" />
								<sh:SyntaxHighlightingTextBlock SourceLanguage="Json"
																SourceCode="{Binding JsonData}" />
							</StackPanel>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>

				<!-- the visibility binding didn't work until I used Bind.Model; not sure why... -->
				<TextBlock Grid.Row="1"
						   cm:Bind.Model="{Binding Documents}"
						   Style="{StaticResource Instruction}"
						   Text="The database contains no documents."
						   Visibility="{Binding HasNoResults, Converter={StaticResource booleanToVisibility}}" d:IsHidden="True" d:IsLocked="True" />

				<c:Pager Grid.Row="2"
						 cm:Bind.Model="{Binding Documents}" />
			</Grid>

		</tk:BusyIndicator>
	</Grid>

</UserControl>