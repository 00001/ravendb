<Infrastructure:View x:Class="Raven.Studio.Features.Stats.StatisticsView"
					 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
					 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
					 xmlns:Infrastructure="clr-namespace:Raven.Studio.Infrastructure"
                     xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
                     xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:Models="clr-namespace:Raven.Studio.Models" mc:Ignorable="d"
                     d:DataContext="{d:DesignInstance Models:ServerModel}">

    <Grid Margin="{StaticResource Margin_ContentPage}" DataContext="{Binding Path=SelectedDatabase.Value.Statistics.Value}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border 
            Grid.Row="0"
            Background="{StaticResource Brush_HeaderBackground}" CornerRadius="4,4,0,0">
            <toolkit:DockPanel Margin="4" LastChildFill="False">
                <StackPanel Orientation="Horizontal">
                    <HyperlinkButton Content="Summary" Style="{StaticResource Style_Link_Breadcrumb_Initial}"
									 NavigateUri="/home"/>
                    <TextBlock Text=">" VerticalAlignment="Center" Margin="4,0"/>
                    <TextBlock Text="Statistics" Style="{StaticResource Style_TextBlock_Breadcrumb}" VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel toolkit:DockPanel.Dock="Right" Orientation="Horizontal">
                    
                </StackPanel>
            </toolkit:DockPanel>
        </Border>

        <ScrollViewer BorderThickness="1"
                      BorderBrush="#FFEAE7E4"
                Background="{StaticResource Brush_SubtleBackground2}"
				  VerticalScrollBarVisibility="Auto"
				  HorizontalScrollBarVisibility="Disabled"
				  Grid.Row="1"
                  Margin="0,10,0,0">
            <Grid HorizontalAlignment="Left">
                <Grid.Resources>
                    <CollectionViewSource x:Key="GroupedTriggersView"  Source="{Binding Triggers}">
                        <CollectionViewSource.GroupDescriptions>
                            <PropertyGroupDescription PropertyName="Type"/>
                        </CollectionViewSource.GroupDescriptions>
                    </CollectionViewSource>
                </Grid.Resources>
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock Text="Count Of Indexes" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <TextBlock Grid.Column="2" Text="{Binding CountOfIndexes}" />

                <TextBlock Grid.Row="1" Text="Tasks Count" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <TextBlock Grid.Row="1" Grid.Column="2" Text="{Binding ApproximateTaskCount}" />

                <TextBlock Grid.Row="2" Text="Count Of Documents" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <TextBlock Grid.Row="2" Grid.Column="2" Text="{Binding CountOfDocuments}" />

                <TextBlock Grid.Row="3" Text="Stale Indexes" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <ItemsControl Grid.Row="3"
						  Grid.Column="2"
						  ItemsSource="{Binding StaleIndexes}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding}" />
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <TextBlock Grid.Row="6" Text="Triggers" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <sdk:DataGrid Grid.Row="6"
						  Grid.Column="2"
						  ItemsSource="{Binding Source={StaticResource GroupedTriggersView}}"
                          Style="{StaticResource Style_DataGrid_NoChrome_NoHeader}"
                          AutoGenerateColumns="False">
                    <sdk:DataGrid.Columns>
                        <sdk:DataGridTextColumn Binding="{Binding Name}"/>
                    </sdk:DataGrid.Columns>
                </sdk:DataGrid>

                <TextBlock Grid.Row="7" Text="Extensions" Style="{StaticResource Style_TextBlock_FieldName}"/>
                <ItemsControl Grid.Row="7"
						  Grid.Column="2"
						  ItemsSource="{Binding Extensions}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontWeight="Bold" />
                                <ItemsControl ItemsSource="{Binding Installed}" Margin="20,0,0,10">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Name}" />
                                                <TextBlock Text=", " />
                                                <TextBlock Text="{Binding Assembly}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </ScrollViewer>
    </Grid>
</Infrastructure:View>