<UserControl x:Name="this"
			 x:Class="Raven.Studio.Features.Indexes.EditIndexView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Editors="clr-namespace:Raven.Studio.Controls.Editors"
			 xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk">
	<Grid>

		<ScrollViewer BorderThickness="0"
					  VerticalScrollBarVisibility="Auto"
					  HorizontalScrollBarVisibility="Auto">

			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="60" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="*" />
					<RowDefinition Height="*" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<TextBlock Text="name" />
				<TextBox Grid.Column="1"
						 Text="{Binding Name, Mode=TwoWay}"
						 Margin="0 0 0 8" />

				<StackPanel Grid.Row="1" Grid.Column="1">
					<HyperlinkButton x:Name="AddReduce"
									 Visibility="{Binding Reduce, Converter={StaticResource HiddenWhenNotNull}}"
									 Command="{Binding AddReduce}"
									 VerticalAlignment="Top"
									 HorizontalAlignment="Left"
									 Content="Add Reduce" />
				</StackPanel>

				<StackPanel Grid.Row="2">
					<TextBlock Text="Maps" />
					<HyperlinkButton x:Name="AddMap"
							ToolTipService.ToolTip="Add map to the index"
							HorizontalAlignment="Left"
							VerticalAlignment="Bottom"
							Content="Add map"
							Command="{Binding Path=DataContext.AddMap, ElementName=this}" />
				</StackPanel>
				<ItemsControl ItemsSource="{Binding Maps}"
							  Grid.Row="2"
							  Grid.Column="1">
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition />
									<RowDefinition />
								</Grid.RowDefinitions>


								<StackPanel Grid.Row="1"
											HorizontalAlignment="Right"
											Margin="0,0,4,0">
									<HyperlinkButton x:Name="RemoveMap"
													 ToolTipService.ToolTip="Remove this map from the index"
													 Content="Remove"
													 Command="{Binding Path=DataContext.RemoveMap, ElementName=this}"
													 CommandParameter="{Binding}" />
								</StackPanel>

								<Editors:LinqEditor Text="{Binding Text, Mode=TwoWay}"
													Style="{StaticResource LinqEditor}" />
							</Grid>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>

				<TextBlock Text="Reduce"
						   Visibility="{Binding Reduce, Converter={StaticResource HiddenWhenNull}}"
						   Grid.Row="3" />
				<StackPanel Grid.Row="3"
							Grid.Column="1"
							Visibility="{Binding Reduce, Converter={StaticResource HiddenWhenNull}}">
					<Editors:LinqEditor Text="{Binding Reduce, Mode=TwoWay}"
										Style="{StaticResource LinqEditor}" />
					<HyperlinkButton x:Name="RemoveReduce"
									 ToolTipService.ToolTip="Remove reduce statement from the index definition"
									 Content="Remove"
									 HorizontalAlignment="Right"
									 Command="{Binding RemoveReduce}"
									 CommandParameter="{Binding}" />
				</StackPanel>


				<!--<sdk:GridSplitter Grid.Row="4"
								Grid.ColumnSpan="2"
								Visibility="{Binding ShouldShowReduce, Converter={StaticResource visibleWhenTrue}}"
								Background="Transparent"
								HorizontalAlignment="Stretch" />

				<TextBlock Text="transform"
						   Visibility="{Binding ShouldShowTransformResults, Converter={StaticResource visibleWhenTrue}}"
						   Grid.Row="5" />
				<Grid Grid.Row="5"
					  Grid.Column="1">
					<Button x:Name="AddTransformResults"
							Style="{StaticResource FormButton}"
							VerticalAlignment="Top"
							HorizontalAlignment="Left"
							Margin="0 0 0 6"
							Content="transform results" />
					<Editors:LinqEditor Visibility="{Binding ShouldShowTransformResults, Converter={StaticResource visibleWhenTrue}}"
										Text="{Binding TransformResults, Mode=TwoWay}" />
				</Grid>

				<sdk:GridSplitter Grid.Row="6"
								Grid.ColumnSpan="2"
								Visibility="{Binding ShouldShowTransformResults, Converter={StaticResource visibleWhenTrue}}"
								Background="Transparent"
								HorizontalAlignment="Stretch" />

				<Button x:Name="AddField"
						Style="{StaticResource FormButton}"
						Grid.Row="7"
						ToolTipService.ToolTip="Customize this index."
						Content="+"
						HorizontalAlignment="Right"
						VerticalAlignment="Top"
						Margin="0,0,4,0" />

				<ItemsControl Grid.Column="1"
							  Grid.Row="7"
							  ItemsSource="{Binding Fields}">
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Border BorderBrush="{StaticResource DividerBrush}"
									BorderThickness="1,0,0,0"
									CornerRadius="5"
									Margin="0,0,0,6"
									VerticalAlignment="Top"
									HorizontalAlignment="Left">
								<Grid Margin="4,4,0,4">
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="Auto" />
										<ColumnDefinition Width="*" />
									</Grid.ColumnDefinitions>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto" />
										<RowDefinition Height="4" />
										<RowDefinition Height="Auto" />
										<RowDefinition Height="4" />
										<RowDefinition Height="Auto" />
									</Grid.RowDefinitions>

									<TextBlock Text="field" />
									<TextBox Text="{Binding Name, Mode=TwoWay}"
											 Grid.Column="1"
											 Grid.ColumnSpan="3" />
									<Button Content="-"
											Style="{StaticResource FormButton}"
											HorizontalAlignment="Left"
											Margin="4 0 0 0"
											Grid.Column="4" />

									<TextBlock Text="storage"
											   Grid.Row="2" />
									<ComboBox ItemsSource="{Binding Storage, Converter={StaticResource enumerationFromValue}, Mode=OneTime}"
											  SelectedItem="{Binding Storage, Converter={StaticResource enumeratedValue}, Mode=TwoWay}"
											  Grid.Row="2"
											  Grid.Column="1"
											  MinWidth="80" />

									<TextBlock Text="indexing"
											   Grid.Row="2"
											   Grid.Column="2"
											   Margin="8,0,4,0" />
									<ComboBox ItemsSource="{Binding Indexing, Converter={StaticResource enumerationFromValue}, Mode=OneTime}"
											  SelectedItem="{Binding Indexing, Converter={StaticResource enumeratedValue}, Mode=TwoWay}"
											  Grid.Row="2"
											  Grid.Column="3" />

									<TextBlock Text="sort"
											   Grid.Row="4" />
									<ComboBox ItemsSource="{Binding Sort, Converter={StaticResource enumerationFromValue}, Mode=OneTime}"
											  SelectedItem="{Binding Sort, Converter={StaticResource enumeratedValue}, Mode=TwoWay}"
											  Grid.Row="4"
											  Grid.Column="1" />

									<TextBlock Text="analyzer"
											   Grid.Row="4"
											   Grid.Column="2"
											   Margin="8,0,4,0" />
									<TextBox Text="{Binding Analyzer}"
											 Grid.Row="4"
											 Grid.Column="3"
											 MinWidth="160" />
								</Grid>
							</Border>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>-->
			</Grid>
		</ScrollViewer>
	</Grid>
</UserControl>